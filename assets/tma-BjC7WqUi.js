import{r as So}from"./vendor-DfnDk_cA.js";let Oe=class Ao extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Ao.prototype)}};function Ui(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const Li="ERR_INVALID_VALUE",Vi="ERR_UNEXPECTED_VALUE",Ii="ERR_UNEXPECTED_TYPE",Ro="ERR_PARSE";function Mi(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new Oe(Ro,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function xo(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new Oe(Li,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new Oe(Vi);return t}function Xe(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new Oe(Ro,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function qi(e,t){return Xe("object",n=>{const r=xo(n);return Mi(e,o=>r[o])})}function ko(e){throw new Oe(Ii,`Unexpected value received: ${JSON.stringify(e)}`)}const Vn=Xe("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();ko(e)});function je(e){return/^#[\da-f]{6}$/i.test(e)}function Wi(e){return/^#[\da-f]{3}$/i.test(e)}function To(e){const t=e.replace(/\s/g,"").toLowerCase();if(je(t))return t;if(Wi(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const Hi=Xe("rgb",e=>To(Vn()(e))),Gi=Xe("themeParams",e=>{const t=Hi(!0);return Object.entries(xo(e)).reduce((n,[r,o])=>(n[Ui(r)]=t(o),n),{})});function Ji(e,t){return Xe("array",n=>{let r;if(Array.isArray(n))r=n;else if(typeof n=="string")try{const o=JSON.parse(n);Array.isArray(o)&&(r=o)}catch{}return r||ko(n),r.map(e)})}function Fi(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Jr(...e){return e.map(t=>{if(typeof t=="string")return t;if(Fi(t))return Jr(Object.entries(t).map(n=>n[1]&&n[0]));if(Array.isArray(t))return Jr(...t)}).filter(Boolean).join(" ")}let De=class Po extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Po.prototype)}};function Oo(e){return e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}function zi(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const Zi="ERR_INVALID_VALUE",Ki="ERR_UNEXPECTED_VALUE",Yi="ERR_UNEXPECTED_TYPE",jo="ERR_PARSE";function Do(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new De(jo,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function Bo(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new De(Zi,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new De(Ki);return t}function F(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new De(jo,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function q(e,t){return F(t||"object",n=>{const r=Bo(n);return Do(e,o=>r[o])})}function Qe(e){throw new De(Yi,`Unexpected value received: ${JSON.stringify(e)}`)}const bt=F("boolean",e=>{if(typeof e=="boolean")return e;const t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;Qe(e)}),D=F("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();Qe(e)}),Be=F("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=Number(e);if(!Number.isNaN(t))return t}Qe(e)}),Xi=F("date",e=>e instanceof Date?e:new Date(Be()(e)*1e3));function No(e,t){return F(t||"searchParams",n=>{typeof n!="string"&&!(n instanceof URLSearchParams)&&Qe(n);const r=typeof n=="string"?new URLSearchParams(n):n;return Do(e,o=>{const s=r.get(o);return s===null?void 0:s})})}function nn(e){for(const t in e)e[t]=[Oo(t),e[t]];return e}const Qi=e=>{const t=Be(),n=Be(!0),r=D(),o=D(!0),s=bt(!0),i=q(nn({addedToAttachmentMenu:s,allowsWriteToPm:s,firstName:r,id:t,isBot:s,isPremium:s,languageCode:o,lastName:o,photoUrl:o,username:o}),"User")(!0);return No(nn({authDate:Xi(),canSendAfter:n,chat:q(nn({id:t,type:r,title:r,photoUrl:o,username:o}),"Chat")(!0),chatInstance:o,chatType:o,hash:r,queryId:o,receiver:i,startParam:o,user:i}),"initData")(e)};function ea(e){return/^#[\da-f]{6}$/i.test(e)}function ta(e){return/^#[\da-f]{3}$/i.test(e)}function na(e){const t=e.replace(/\s/g,"").toLowerCase();if(ea(t))return t;if(ta(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const ra=F("rgb",e=>na(D()(e))),oa=F("themeParams",e=>{const t=ra(!0);return Object.entries(Bo(e)).reduce((n,[r,o])=>(n[zi(r)]=t(o),n),{})});function sa(e){return JSON.stringify(Object.fromEntries(Object.entries(e).map(([t,n])=>[Oo(t),n])))}const ia=e=>{const t=D(),n=D(!0),r=bt(!0);return No({botInline:["tgWebAppBotInline",r],initData:["tgWebAppData",Qi(!0)],initDataRaw:["tgWebAppData",n],platform:["tgWebAppPlatform",t],showSettings:["tgWebAppShowSettings",r],startParam:["tgWebAppStartParam",n],themeParams:["tgWebAppThemeParams",oa()],version:["tgWebAppVersion",t]},"launchParams")(e)};function aa(e){const{initDataRaw:t,startParam:n,showSettings:r,botInline:o}=e,s=new URLSearchParams;return s.set("tgWebAppPlatform",e.platform),s.set("tgWebAppThemeParams",sa(e.themeParams)),s.set("tgWebAppVersion",e.version),t&&s.set("tgWebAppData",t),n&&s.set("tgWebAppStartParam",n),typeof r=="boolean"&&s.set("tgWebAppShowSettings",r?"1":"0"),typeof o=="boolean"&&s.set("tgWebAppBotInline",o?"1":"0"),s.toString()}const ca=q({eventType:D(),eventData:e=>e},"miniAppsMessage"),Uo=F("fn",e=>{if(typeof e=="function")return e;Qe(e)});function ua(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}const pa=q({TelegramWebviewProxy:q({postEvent:Uo()})()});function Lo(e){return pa().isValid(e)}function la(){try{return window.self!==window.top}catch{return!0}}var fa=Object.defineProperty,_a=(e,t,n)=>t in e?fa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vo=(e,t,n)=>_a(e,typeof t!="symbol"?t+"":t,n);let g=class Io extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Io.prototype)}};function wn(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function fe(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}const da="ERR_ABORTED",ha="ERR_CANCELED",ba="ERR_TIMED_OUT";function Fr(e){return new g(da,{cause:e})}function zr(e,t){return e.reject=t.reject,e}let J=class st extends Promise{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s,i;super((a,u)=>{o||(o={});const{abortSignal:c}=o;if(c&&c.aborted)return u(Fr(c.reason));const[p,h]=fe(),b=l=>(...A)=>(h(),l(...A)),E=new AbortController,{signal:w}=E;i=b(l=>{E.abort(l),u(l)}),s=b(a),c&&p(wn(c,"abort",()=>{i(Fr(c.reason))}));const{timeout:d}=o;if(d){const l=setTimeout(()=>{i(new g(ba,`Timeout reached: ${d}ms`))},d);p(()=>{clearTimeout(l)})}r&&r(s,i,w)}),Vo(this,"reject"),this.reject=i}static withFn(t,n){return new st((r,o,s)=>{try{const i=t(s);return i instanceof Promise?i.then(r,o):r(i)}catch(i){o(i)}},n)}static resolve(t){return new st(n=>{n(t)})}static reject(t){return new st((n,r)=>{r(t)})}cancel(){this.reject(new g(ha))}catch(t){return this.then(void 0,t)}finally(t){return zr(super.finally(t),this)}then(t,n){return zr(super.then(t,n),this)}};function Zr(e,t){return e.resolve=t.resolve,e}let ga=class it extends J{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s;super((i,a,u)=>{s=i,r&&r(i,a,u)},o),Vo(this,"resolve"),this.resolve=s}static withFn(t,n){return new it((r,o,s)=>J.withFn(t,{abortSignal:s}).then(r,o),n)}static resolve(t){return new it(n=>{n(t)})}static reject(t){return new it((n,r)=>{r(t)})}catch(t){return this.then(void 0,t)}finally(t){return Zr(super.finally(t),this)}then(t,n){return Zr(super.then(t,n),this)}};function Mo(e){return`tapps/${e}`}function N(e,t){sessionStorage.setItem(Mo(e),JSON.stringify(t))}function U(e){const t=sessionStorage.getItem(Mo(e));try{return t?JSON.parse(t):void 0}catch{}}function In(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function ma(e,t){t||(t={});const{textColor:n,bgColor:r,shouldLog:o=!0}=t;function s(i,...a){if(!o||typeof o=="function"&&!o())return;const u="font-weight:bold;padding:0 5px;border-radius:5px";console[i](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${u};background-color: lightblue;color:black`,"",`${u};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...a)}return[function(...i){s("log",...i)},function(...i){s("error",...i)}]}function Mn(e,t){document.documentElement.style.setProperty(e,t)}function qn(e){document.documentElement.style.removeProperty(e)}function wa(e,t){t()}function _e(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const p=o;o=c,wa(u,()=>{[...r].forEach(([h,b])=>{h(c,p),b&&a(h,!0)})})}};function i(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const a=(c,p)=>{const h=i(p),b=r.findIndex(([E,w])=>E===c&&w.once===h.once&&w.signal===h.signal);b>=0&&r.splice(b,1)},u=Object.assign(function(){return ya(u),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,p){return r.push([c,i(p)]),()=>a(c,p)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return u}const rn=[];function ya(e){rn.length&&rn[rn.length-1].add(e)}const $a=_e(!1),[qo,va]=ma("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:$a}),Ea={clipboard_text_received:q({req_id:D(),data:e=>e===null?e:D(!0)(e)},"clipboard_text_received"),custom_method_invoked:q({req_id:D(),result:e=>e,error:D(!0)},"custom_method_invoked"),popup_closed:F("popup_closed",e=>e?q({button_id:t=>t==null?void 0:D()(t)})()(e):{}),viewport_changed:q({height:Be(),width:e=>e==null?window.innerWidth:Be()(e),is_state_stable:bt(),is_expanded:bt()},"viewport_changed")};function Ca(e){const t=window,[,n]=fe(wn(t,"resize",()=>{e(["viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0}])}),wn(t,"message",r=>{if(r.source!==t.parent)return;let o;try{o=ca()(r.data)}catch{return}const{eventType:s,eventData:i}=o,a=Ea[s];try{const u=a?a()(i):i;qo("Event received:",u?{eventType:s,eventData:u}:{eventType:s}),e([s,u])}catch(u){va([`An error occurred processing the "${s}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),o,u)}}));return n}const Kr=_e(),Yr=_e();function Sa(){return Yr()||Yr.set(Ca(Kr.set)),Kr}const on=_e({});function Wo(e){let t=on()[e];return t||(t=_e(void 0,{equals(){return!1}}),Sa().sub(n=>{n&&n[0]===e&&t.set(n[1])}),on.set({...on(),[e]:t})),t}function O(e,t,n){return Wo(e).sub(t,n)}const Aa="ERR_METHOD_UNSUPPORTED",Ra="ERR_RETRIEVE_LP_FAILED",xa="ERR_METHOD_PARAMETER_UNSUPPORTED",Ho="ERR_UNKNOWN_ENV",ka="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",Ta=_e("https://web.telegram.org");function Wn(e,t){qo("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const n=window;if(Lo(n)){n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}const r=JSON.stringify({eventType:e,eventData:t});if(la())return n.parent.postMessage(r,Ta());const{external:o}=n;if(q({notify:Uo()})().isValid(o)){o.notify(r);return}throw new g(Ho)}function Hn(e,t,n){n||(n={});const{capture:r}=n,[o,s]=fe();return new J(i=>{(Array.isArray(t)?t:[t]).forEach(a=>{o(O(a,u=>{(!r||(Array.isArray(t)?r({event:a,payload:u}):r(u)))&&i(u)}))}),(n.postEvent||Wn)(e,n.params)},n).finally(s)}function Go(e){return ia()(e)}function Jo(e){return Go(e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function Pa(){return Jo(window.location.href)}function Oa(){const e=performance.getEntriesByType("navigation")[0];if(!e)throw new Error("Unable to get first navigation entry.");return Jo(e.name)}const ja="launchParams";function Da(){return Go(U(ja)||"")}function Ba(e){N("launchParams",aa(e))}function Fo(e){return e instanceof Error?e.message+(e.cause?`
  ${Fo(e.cause)}`:""):JSON.stringify(e)}function et(){const e=[];for(const t of[Pa,Oa,Da])try{const n=t();return Ba(n),n}catch(n){e.push(n)}throw new g(Ra,["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment","Collected errors:",...e.map(t=>`â€” ${Fo(t)}`)].join(`
`))}function Xr(e){try{return et(),!0}catch{return!1}return J.withFn(async()=>{if(Lo(window))return!0;try{return await Hn("web_app_request_theme","theme_changed",{timeout:100}),!0}catch{return!1}},e)}function Na(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}function Ua(){[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{let t=window;e.forEach((n,r,o)=>{if(r===o.length-1){t[n]=Na;return}n in t||(t[n]={}),t=t[n]})})}function La(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(e=>{delete window[e]})}function de(e,t,n){Wo(e).unsub(t,n)}function Va(e){return({req_id:t})=>t===e}function Qr(e){return e.split(".").map(Number)}function Ia(e,t){const n=Qr(e),r=Qr(t),o=Math.max(n.length,r.length);for(let s=0;s<o;s+=1){const i=n[s]||0,a=r[s]||0;if(i!==a)return i>a?1:-1}return 0}function R(e,t){return Ia(e,t)<=0}function oe(e,t,n){if(typeof n=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return R("6.4",n);if(t==="try_browser")return R("7.6",n)}if(e==="web_app_set_header_color"&&t==="color")return R("6.9",n);if(e==="web_app_close"&&t==="return_back")return R("7.6",n);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return R("7.10",n)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return R("6.1",t);case"web_app_open_popup":return R("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return R("6.4",t);case"web_app_switch_inline_query":return R("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return R("6.9",t);case"web_app_setup_settings_button":return R("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return R("7.2",t);case"web_app_setup_swipe_behavior":return R("7.7",t);case"web_app_share_to_story":return R("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return R("7.10",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Ma(e,t){t||(t="strict");const n=typeof t=="function"?t:r=>{const{method:o,version:s}=r;let i,a;if("param"in r?(i=`Parameter "${r.param}" of "${o}" method is unsupported in Mini Apps version ${s}`,a=xa):(i=`Method "${o}" is unsupported in Mini Apps version ${s}`,a=Aa),t==="strict")throw new g(a,i);return console.warn(i)};return(r,o)=>oe(r,e)?ua(o)&&r==="web_app_set_header_color"&&"color"in o&&!oe(r,"color",e)?n({version:e,method:r,param:"color"}):Wn(r,o):n({version:e,method:r})}function qa(e,t,n,r){return Hn("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:e,params:t,req_id:n},capture:Va(n)}).then(({result:o,error:s})=>{if(s)throw new g(ka,s);return o})}function Wa(){return performance.getEntriesByType("navigation")[0]}function z(){const e=Wa();return!!e&&e.type==="reload"}let ce;function Ha(e,t){ce&&ce.set(e,t)||t()}function Ga(e){if(ce)return e();ce=new Map;try{e()}finally{ce.forEach(t=>t()),ce=void 0}}function f(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const p=o;o=c,Ha(u,()=>{[...r].forEach(([h,b])=>{h(c,p),b&&a(h,!0)})})}};function i(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const a=(c,p)=>{const h=i(p),b=r.findIndex(([E,w])=>E===c&&w.once===h.once&&w.signal===h.signal);b>=0&&r.splice(b,1)},u=Object.assign(function(){return Ja(u),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,p){return r.push([c,i(p)]),()=>a(c,p)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return u}const Se=[];function Ja(e){Se.length&&Se[Se.length-1].add(e)}function C(e,t){let n=new Set,r;function o(){return r||(r=f(i(),t))}function s(){o().set(i())}function i(){n.forEach(c=>{c.unsub(s,{signal:!0})});const a=new Set;let u;Se.push(a);try{u=e()}finally{Se.pop()}return a.forEach(c=>{c.sub(s,{signal:!0})}),n=a,u}return Object.assign(function(){return o()()},{destroy(){o().destroy()},sub(...a){return o().sub(...a)},unsub(...a){o().unsub(...a)},unsubAll(...a){o().unsubAll(...a)}})}const Fa=f((()=>{let e=0;return()=>(e+=1).toString()})()),zo=f(Wn),Y=f("0.0");function za(e){e||(e={});const{postEvent:t}=e,n=e.version||et().version;Y.set(n),zo.set(typeof t=="function"?t:Ma(n))}function Za(){return Fa()()}function vt(e,t,n){return qa(e,t,Za(),{...n||{},postEvent:y})}const ie=(e,t,n)=>(n||(n={}),n.postEvent||(n.postEvent=y),Hn(e,t,n)),y=(e,t)=>zo()(e,t);function Ka(e){return C(()=>oe(e,Y()))}const $e="ERR_POPUP_INVALID_PARAMS",Gn="ERR_INVALID_URL",Ya="ERR_INVALID_SLUG",Zo="ERR_ALREADY_REQUESTING",Jn="ERR_ALREADY_OPENED",Xa="ERR_ALREADY_MOUNTING",Qa="ERR_VARS_ALREADY_BOUND",ec="ERR_NOT_AVAILABLE",tc="ERR_NOT_INITIALIZED",eo="ERR_NOT_SUPPORTED",nc="ERR_NOT_MOUNTED";function to(){return typeof window>"u"}function Ko(e,t,{isSupported:n,isMounted:r,component:o,supports:s}={}){const i=`${o?`${o}.`:""}${e}()`;n=n?Array.isArray(n)||typeof n=="object"&&"any"in n?n:[n]:void 0;function a(d){if(s){const l=s[d];return oe(l[0],l[1],Y())}return!0}const u=()=>{if(!n)return;const d=`it is unsupported in Mini Apps version ${Y()}`;function l(v){return typeof v=="string"?oe(v,Y())?void 0:d:v.fn()?void 0:v.error}if(Array.isArray(n)){for(const v of n){const ye=l(v);if(ye)return ye}return}let A;for(const v of n.any)if(A=l(v),!A)return;return d},c=(...d)=>{if(s){for(const l in s)if(s[l][2](...d)&&!a(l))return`option ${l} is not supported in Mini Apps version ${Y()}`}},p=C(()=>!u()),h=C(()=>Y()!=="0.0"),b=C(()=>!r||r()),E=C(()=>Xr("simple")&&!to()&&h()&&p()&&b());let w;if(s){w={};for(const d in s)w[d]=C(()=>a(d))}return Object.assign((...d)=>{const l=`Unable to call the ${i} ${o?"method":"function"}:`;if(to()||!Xr("simple"))throw new g(Ho,`${l} it can't be called outside Mini Apps`);if(!h())throw new g(tc,`${l} the SDK was not initialized. Use the SDK init() function`);const A=u();if(A)throw new g(eo,`${l} ${A}`);const v=c(...d);if(v)throw new g(eo,`${l} ${v}`);if(!b())throw new g(nc,`${l} the component is not mounted. Use the ${o}.mount() method`);return t(...d)},t,{isAvailable:E,ifAvailable(...d){return E()?t(...d):void 0}},n?{isSupported:p}:{},w?{supports:w}:{})}function Et(e,t){return t||(t={}),(n,r,o,s)=>Ko(n,r,{...t,isSupported:o||t.isSupported,supports:s,component:e})}function he(e,t,n){return Et(e,{isSupported:n,isMounted:t})}function L(e,t){return Et(e,{isSupported:t})}const Ct="web_app_setup_back_button",Yo="back_button_pressed",St="backButton",yn=f(!1),Ne=f(!1),rc=Ka(Ct),Xo=he(St,Ne,Ct),Fn=L(St,Ct),oc=Xo("hide",()=>{zn(!1)}),sc=Fn("mount",()=>{Ne()||(zn(z()&&U(St)||!1),Ne.set(!0))});function zn(e){e!==yn()&&(y(Ct,{is_visible:e}),N(St,e),yn.set(e))}const ic=Fn("onClick",e=>O(Yo,e)),ac=Fn("offClick",e=>{de(Yo,e)}),cc=Xo("show",()=>{zn(!0)});function uc(){Ne.set(!1)}const nf=Object.freeze(Object.defineProperty({__proto__:null,hide:oc,isMounted:Ne,isSupported:rc,isVisible:yn,mount:sc,offClick:ac,onClick:ic,show:cc,unmount:uc},Symbol.toStringTag,{value:"Module"}));function Qo(e,t,n,{isMounting:r,isMounted:o,mountError:s}){return i=>J.withFn(async a=>{if(o())return;if(r())throw new g(Xa,`The ${e} component is already mounting`);r.set(!0);let u;try{u=[!0,await t({abortSignal:a})]}catch(c){u=[!1,c]}Ga(()=>{if(r.set(!1),o.set(!0),u[0])n(u[1]);else{const c=u[1];throw s.set(c),c}})},i)}const Q=Et,es=f(),sn=f(!1),an=f(!1),ts=f(!1),pc=f(!1),lc=f(void 0);function Zn(e){return e.available?{available:!0,tokenSaved:e.token_saved,deviceId:e.device_id,accessRequested:e.access_requested,type:e.type,accessGranted:e.access_granted}:{available:!1}}const no="web_app_biometry_get_info",fc=Ko("requestBiometry",e=>ie(no,"biometry_info_received",e).then(Zn),{isSupported:no}),Kn="web_app_biometry_request_auth",_c="web_app_biometry_request_access",dc="web_app_biometry_open_settings",hc="web_app_biometry_update_token",ns="biometry_info_received",pe="biometry",bc=Q(pe),gc=L(pe,Kn),Yn=he(pe,ts,Kn);function rs(){throw new g(ec,"Biometry is not available")}Yn("authenticate",e=>J.withFn(async t=>{if(sn())throw new g(Zo,"Authentication is already in progress");const n=es();(!n||!n.available)&&rs(),sn.set(!0);try{const r=await ie(Kn,"biometry_auth_requested",{abortSignal:t,params:{reason:((e||{}).reason||"").trim()}}),{token:o}=r;return typeof o=="string"&&At({...n,token:o}),r}finally{sn.set(!1)}},e));gc("openSettings",()=>{y(dc)});Yn("requestAccess",e=>J.withFn(async t=>{if(an())throw new g(Zo,"Access request is already in progress");an.set(!0);try{const n=await ie(_c,ns,{abortSignal:t,params:{reason:(e||{}).reason||""}}).then(Zn);return n.available||rs(),At(n),n.accessGranted}finally{an.set(!1)}},e));bc("mount",Qo(pe,e=>z()&&U(pe)||fc(e),e=>{O(ns,mc),At(e)},{isMounted:ts,mountError:lc,isMounting:pc}));const mc=e=>{At(Zn(e))};function At(e){es.set(e),N(pe,e)}Yn("updateToken",e=>(e||(e={}),ie(hc,"biometry_token_updated",{...e,params:{token:e.token||"",reason:e.reason}}).then(t=>t.status)));function Rt(e,t){return Et(e,{isMounted:t})}const xt="closingBehavior",ro=f(!1),$n=f(!1),os=Rt(xt,$n),wc=Q(xt);os("disableConfirmation",()=>{Xn(!1)});os("enableConfirmation",()=>{Xn(!0)});wc("mount",()=>{$n()||(Xn(z()&&U(xt)||!1),$n.set(!0))});function Xn(e){e!==ro()&&(y("web_app_setup_closing_behavior",{need_confirmation:e}),N(xt,e),ro.set(e))}const yc="web_app_invoke_custom_method",kt=L("cloudStorage",yc);kt("deleteItem",(e,t)=>{const n=Array.isArray(e)?e:[e];return n.length?vt("deleteStorageValues",{keys:n},t).then():J.resolve()});function $c(e,t){const n=Array.isArray(e)?e:[e];return n.length?vt("getStorageValues",{keys:n},t).then(r=>{const o=qi(Object.fromEntries(n.map(s=>[s,Vn()])))()(r);return Array.isArray(e)?o:o[e]}):J.resolve(typeof e=="string"?"":{})}kt("getItem",$c);kt("getKeys",e=>vt("getStorageKeys",{},e).then(Ji(Vn())()));kt("setItem",(e,t,n)=>vt("saveStorageValue",{key:e,value:t},n).then());const Tt="web_app_trigger_haptic_feedback",Qn=L("hapticFeedback",Tt);Qn("impactOccurred",e=>{y(Tt,{type:"impact",impact_style:e})});Qn("notificationOccurred",e=>{y(Tt,{type:"notification",notification_type:e})});Qn("selectionChanged",()=>{y(Tt,{type:"selection_change"})});const ss="web_app_open_invoice",vc=L("invoice",ss),cn=f(!1);async function Ec(e,t,n){if(cn())throw new g(Jn,"An invoice is already opened");let r;if(t==="url"){const{hostname:o,pathname:s}=new URL(e,window.location.href);if(o!=="t.me")throw new g(Gn,`Link has unexpected hostname: ${o}`);const i=s.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!i)throw new g(Ya,'Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,r]=i}else r=e,n=t;return cn.set(!0),ie(ss,"invoice_closed",{...n,params:{slug:r},capture:o=>r===o.slug}).then(o=>o.status).finally(()=>{cn.set(!1)})}vc("open",Ec);function is(e){const t=To(e);return Math.sqrt([.299,.587,.114].reduce((n,r,o)=>{const s=parseInt(t.slice(1+o*2,1+(o+1)*2),16);return n+s*s*r},0))<120}const Ue=f(!1),at=f(!1),ne=f({});function k(e){return C(()=>ne()[e])}const Cc=k("accentTextColor"),er=k("bgColor"),tr=k("buttonColor"),as=k("buttonTextColor"),cs=k("bottomBarBgColor"),Sc=k("destructiveTextColor"),Ac=k("headerBgColor"),Rc=k("hintColor"),xc=C(()=>{const{bgColor:e}=ne();return!e||is(e)}),kc=k("linkColor"),gt=k("secondaryBgColor"),Tc=k("sectionBgColor"),Pc=k("sectionHeaderTextColor"),Oc=k("sectionSeparatorColor"),jc=k("subtitleTextColor"),Dc=k("textColor"),Ae=f({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),Bc=C(()=>{const e=Ae();return{...e,backgroundColor:e.backgroundColor||tr()||"#2481cc",textColor:e.textColor||as()||"#ffffff"}}),vn=f(!1),Nc="web_app_setup_main_button",us="main_button_pressed",Pt="mainButton",nr=Q(Pt),Uc=Rt(Pt,vn);nr("mount",()=>{if(!vn()){const e=z()&&U(Pt);e&&Ae.set(e),vn.set(!0)}});nr("onClick",e=>O(us,e));nr("offClick",e=>{de(us,e)});Uc("setParams",e=>{Ae.set({...Ae(),...Object.fromEntries(Object.entries(e).filter(([,n])=>n!==void 0))}),N(Pt,Ae());const t=Bc();t.text&&y(Nc,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,text:t.text,text_color:t.textColor})});function rr(){throw new g(Qa,"CSS variables are already bound")}function Lc(e){return Gi()(e)}const Ot="themeParams",ps="theme_changed",Vc=Q(Ot),Ic=Rt(Ot,Ue),Mc=Ic("bindCssVars",e=>{at()&&rr(),e||(e=r=>`--tg-theme-${In(r)}`);function t(r){Object.entries(ne()).forEach(([o,s])=>{s&&r(o,s)})}function n(){t((r,o)=>{Mn(e(r),o)})}return n(),ne.sub(n),at.set(!0),()=>{t(qn),ne.unsub(n),at.set(!1)}}),ls=Vc("mount",()=>{Ue()||(O(ps,fs),ne.set(z()&&U(Ot)||et().themeParams),Ue.set(!0))}),fs=e=>{const t=Lc(e.theme_params);ne.set(t),N(Ot,t)};function qc(){de(ps,fs),Ue.set(!1)}function _s(e){return C(()=>{const t=e();return je(t)?t:t==="bg_color"?er():gt()})}const Le=f("bg_color"),or=_s(Le),Ve=f("bottom_bar_bg_color"),sr=C(()=>{const e=Ve();return je(e)?e:e==="bottom_bar_bg_color"?cs()||gt():e==="secondary_bg_color"?gt():er()}),Ie=f("bg_color"),ds=_s(Ie),Me=f(!1),ct=f(!1),Wc=C(()=>{const e=or();return e?is(e):!1}),hs=C(()=>({backgroundColor:Le(),bottomBarColor:Ve(),headerColor:Ie()})),En="web_app_set_background_color",Cn="web_app_set_bottom_bar_color",ut="web_app_set_header_color",tt="miniApp",ir={any:[En,Cn,ut]},Hc=C(()=>ir.any.some(e=>oe(e,Y()))),bs=Q(tt),Gc=L(tt,ir),jt=he(tt,Me,ir),Jc=jt("bindCssVars",e=>{ct()&&rr();const[t,n]=fe();function r(o,s){function i(){Mn(o,s()||null)}i(),t(s.sub(i),qn.bind(null,o))}return e||(e=o=>`--tg-${In(o)}`),r(e("bgColor"),or),r(e("bottomBarColor"),sr),r(e("headerColor"),ds),t(()=>{ct.set(!1)}),ct.set(!0),n}),Fc=bs("close",e=>{y("web_app_close",{return_back:e})}),zc=Gc("mount",()=>{if(!Me()){const e=z()&&U(tt);ls(),gs.ifAvailable(e?e.backgroundColor:"bg_color"),ms.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),ws.ifAvailable(e?e.headerColor:"bg_color"),Me.set(!0)}}),Zc=bs("ready",()=>{y("web_app_ready")});function ar(){N(tt,hs())}const gs=jt("setBackgroundColor",e=>{e!==Le()&&(y(En,{color:e}),Le.set(e),ar())},En),ms=jt("setBottomBarColor",e=>{e!==Ve()&&(y(Cn,{color:e}),Ve.set(e),ar())},Cn),ws=jt("setHeaderColor",e=>{e!==Ie()&&(y(ut,je(e)?{color:e}:{color_key:e}),Ie.set(e),ar())},ut,{rgb:[ut,"color",je]});function Kc(){Me.set(!1)}const rf=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:Le,backgroundColorRGB:or,bindCssVars:Jc,bottomBarColor:Ve,bottomBarColorRGB:sr,close:Fc,headerColor:Ie,headerColorRGB:ds,isCssVarsBound:ct,isDark:Wc,isMounted:Me,isSupported:Hc,mount:zc,ready:Zc,setBackgroundColor:gs,setBottomBarColor:ms,setHeaderColor:ws,state:hs,unmount:Kc},Symbol.toStringTag,{value:"Module"}));function Yc(e){const t=e.message.trim(),n=(e.title||"").trim(),r=e.buttons||[];if(n.length>64)throw new g($e,`Invalid title: ${n}`);if(!t||t.length>256)throw new g($e,`Invalid message: ${t}`);if(r.length>3)throw new g($e,`Invalid buttons count: ${r.length}`);return{title:n,message:t,buttons:r.length?r.map((o,s)=>{const i=o.id||"";if(i.length>64)throw new g($e,`Button with index ${s} has invalid id: ${i}`);if(!o.type||o.type==="default"||o.type==="destructive"){const a=o.text.trim();if(!a||a.length>64)throw new g($e,`Button with index ${s} has invalid text: ${a}`);return{type:o.type,text:a,id:i}}return{type:o.type,id:i}}):[{type:"close",id:""}]}}const ys="web_app_open_popup",Xc=L("popup",ys),un=f(!1);Xc("open",async e=>{if(un())throw new g(Jn,"A popup is already opened");un.set(!0);try{const{button_id:t=null}=await ie(ys,"popup_closed",{...e,params:Yc(e)});return t}finally{un.set(!1)}});const Qc="web_app_close_scan_qr_popup",$s="web_app_open_scan_qr_popup",eu="scan_qr_popup_closed",tu="qr_text_received",vs=L("qrScanner",$s),oo=vs("close",()=>{Ee.set(!1),y(Qc)}),Ee=f(!1);function nu(e){return J.withFn(t=>{if(Ee())throw new g(Jn,"The QR Scanner is already opened");Ee.set(!0),e||(e={});const{onCaptured:n,text:r,capture:o}=e,[,s]=fe(Ee.sub(()=>{i.resolve()}),O(eu,()=>{Ee.set(!1)}),O(tu,a=>{n?n(a.data):(!o||o(a.data))&&(i.resolve(a.data),oo())})),i=new ga({abortSignal:t}).catch(oo).finally(s);return(e.postEvent||y)($s,{text:r}),i},e)}vs("open",nu);const Re=f({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),ru=C(()=>{const e=Re();return{...e,backgroundColor:e.backgroundColor||sr()||"#000000",textColor:e.textColor||tr()||"#2481cc"}}),Sn=f(!1),cr="web_app_setup_secondary_button",Es="secondary_button_pressed",Dt="secondaryButton",ur=L(Dt,cr),ou=he(Dt,Sn,cr);ur("mount",()=>{if(!Sn()){const e=z()&&U(Dt);e&&Re.set(e),Sn.set(!0)}});ur("onClick",e=>O(Es,e));ur("offClick",e=>{de(Es,e)});ou("setParams",e=>{Re.set({...Re(),...Object.fromEntries(Object.entries(e).filter(([,n])=>n!==void 0))}),N(Dt,Re());const t=ru();t.text&&y(cr,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,position:t.position,text:t.text,text_color:t.textColor})});const pr="web_app_setup_settings_button",Cs="settings_button_pressed",Bt="settingsButton",so=f(!1),An=f(!1),lr=L(Bt,pr),Ss=he(Bt,An,pr);Ss("hide",()=>{fr(!1)});lr("mount",()=>{An()||(fr(z()&&U(Bt)||!1),An.set(!0))});function fr(e){e!==so()&&(y(pr,{is_visible:e}),N(Bt,e),so.set(e))}lr("onClick",e=>O(Cs,e));lr("offClick",e=>{de(Cs,e)});Ss("show",()=>{fr(!0)});const _r="web_app_setup_swipe_behavior",Nt="swipeBehavior",Rn=f(!1),io=f(!0),su=L(Nt,_r),As=he(Nt,Rn,_r);As("disableVertical",()=>{dr(!1)});As("enableVertical",()=>{dr(!0)});su("mount",()=>{Rn()||(dr(z()&&U(Nt)||!1,!0),Rn.set(!0))});function dr(e,t){(e!==io()||t)&&(y(_r,{allow_vertical_swipe:e}),N(Nt,e),io.set(e))}const of=Object.freeze(Object.defineProperty({__proto__:null,accentTextColor:Cc,backgroundColor:er,bindCssVars:Mc,bottomBarBgColor:cs,buttonColor:tr,buttonTextColor:as,destructiveTextColor:Sc,headerBackgroundColor:Ac,hintColor:Rc,isCssVarsBound:at,isDark:xc,isMounted:Ue,linkColor:kc,mount:ls,secondaryBackgroundColor:gt,sectionBackgroundColor:Tc,sectionHeaderTextColor:Pc,sectionSeparatorColor:Oc,state:ne,subtitleTextColor:jc,textColor:Dc,unmount:qc},Symbol.toStringTag,{value:"Module"})),H=f({height:0,width:0,isExpanded:!1,stableHeight:0}),Ut=f(!1),pt=f(!1),Rs=f(!1),xs=f(void 0);function Lt(e){return C(()=>H()[e])}const iu=Lt("height"),au=Lt("isExpanded"),cu=C(()=>{const e=H();return e.height===e.stableHeight}),uu=Lt("stableHeight"),pu=Lt("width");function lu(e){return ie("web_app_request_viewport","viewport_changed",e).then(t=>({height:t.height,width:t.width,isExpanded:t.is_expanded,isStable:t.is_state_stable}))}const mt="viewport",ks=Q(mt),fu=Rt(mt,Ut),_u=fu("bindCssVars",e=>{pt()&&rr(),e||(e=r=>`--tg-viewport-${In(r)}`);const t=["height","width","stableHeight"];function n(){t.forEach(r=>{Mn(e(r),`${H()[r]}px`)})}return n(),H.sub(n),pt.set(!0),()=>{t.forEach(qn),H.unsub(n),pt.set(!1)}}),du=ks("expand",()=>{y("web_app_expand")}),hu=ks("mount",Qo(mt,e=>{const t=z()&&U(mt);if(t)return t;if(["macos","tdesktop","unigram","webk","weba","web"].includes(et().platform)){const n=window;return{isExpanded:!0,height:n.innerHeight,width:n.innerWidth,stableHeight:n.innerHeight}}return e.timeout||(e.timeout=1e3),lu(e).then(n=>({height:n.height,isExpanded:n.isExpanded,stableHeight:n.isStable?n.height:H().stableHeight,width:n.width}))},e=>{O("viewport_changed",Ts),Ps(e)},{isMounted:Ut,isMounting:Rs,mountError:xs})),Ts=e=>{Ps({height:e.height,isExpanded:e.is_expanded,stableHeight:e.is_state_stable?e.height:H().stableHeight,width:e.width})};function Ps(e){H.set({isExpanded:e.isExpanded,height:pn(e.height),width:pn(e.width),stableHeight:pn(e.stableHeight)}),N("viewport",H())}function pn(e){return Math.max(e,0)}function bu(){de("viewport_changed",Ts),Ut.set(!1)}const sf=Object.freeze(Object.defineProperty({__proto__:null,bindCssVars:_u,expand:du,height:iu,isCssVarsBound:pt,isExpanded:au,isMounted:Ut,isMounting:Rs,isStable:cu,mount:hu,mountError:xs,stableHeight:uu,state:H,unmount:bu,width:pu},Symbol.toStringTag,{value:"Module"})),gu=Q(),af=gu("openLink",(e,t)=>{if(typeof e=="string")try{e=new URL(e)}catch(n){throw new g(Gn,`"${e.toString()}" is invalid URL`,n)}t||(t={}),y("web_app_open_link",{url:e.toString(),try_browser:t.tryBrowser,try_instant_view:t.tryInstantView})}),ao="web_app_open_tg_link",mu=Q(),wu=mu("openTelegramLink",e=>{const t=e.toString();if(!t.match(/^https:\/\/t.me\/.+/))throw new g(Gn,`"${t}" is invalid URL`);if(!oe(ao,Y())){window.location.href=t;return}e=new URL(e),y(ao,{path_full:e.pathname+e.search})}),yu=Q();yu("shareURL",(e,t)=>{wu("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))});function cf(e){za(e),Ua();const[t,n]=fe(O("reload_iframe",()=>{y("iframe_will_reload"),window.location.reload()}),La),{acceptCustomStyles:r=!0}={};if(r){const o=document.createElement("style");o.id="telegram-custom-styles",document.head.appendChild(o),t(O("set_custom_style",s=>{o.innerHTML=s}),()=>{document.head.removeChild(o)})}return y("iframe_ready",{reload_supported:!0}),n}function uf(){return So.useMemo(et,[])}function pf(e){return So.useSyncExternalStore(t=>e.sub(t),e)}let qe=class Os extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Os.prototype)}};function $u(e){return e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}function vu(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const Eu="ERR_INVALID_VALUE",Cu="ERR_UNEXPECTED_VALUE",Su="ERR_UNEXPECTED_TYPE",js="ERR_PARSE";function Ds(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new qe(js,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function Bs(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new qe(Eu,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new qe(Cu);return t}function ee(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new qe(js,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function xn(e,t){return ee(t||"object",n=>{const r=Bs(n);return Ds(e,o=>r[o])})}function nt(e){throw new qe(Su,`Unexpected value received: ${JSON.stringify(e)}`)}const Au=ee("boolean",e=>{if(typeof e=="boolean")return e;const t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;nt(e)}),We=ee("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();nt(e)}),kn=ee("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=Number(e);if(!Number.isNaN(t))return t}nt(e)}),Ru=ee("date",e=>e instanceof Date?e:new Date(kn()(e)*1e3));function xu(e,t){return ee(t,n=>{typeof n!="string"&&!(n instanceof URLSearchParams)&&nt(n);const r=typeof n=="string"?new URLSearchParams(n):n;return Ds(e,o=>{const s=r.get(o);return s===null?void 0:s})})}function ln(e){for(const t in e)e[t]=[$u(t),e[t]];return e}const ku=e=>{const t=kn(),n=kn(!0),r=We(),o=We(!0),s=Au(!0),i=xn(ln({addedToAttachmentMenu:s,allowsWriteToPm:s,firstName:r,id:t,isBot:s,isPremium:s,languageCode:o,lastName:o,photoUrl:o,username:o}),"User")(!0);return xu(ln({authDate:Ru(),canSendAfter:n,chat:xn(ln({id:t,type:r,title:r,photoUrl:o,username:o}),"Chat")(!0),chatInstance:o,chatType:o,hash:r,queryId:o,receiver:i,startParam:o,user:i}),"initData")(e)};function He(e){return/^#[\da-f]{6}$/i.test(e)}function Tu(e){return/^#[\da-f]{3}$/i.test(e)}function Ns(e){const t=e.replace(/\s/g,"").toLowerCase();if(He(t))return t;if(Tu(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const Pu=ee("rgb",e=>Ns(We()(e))),Ou=ee("themeParams",e=>{const t=Pu(!0);return Object.entries(Bs(e)).reduce((n,[r,o])=>(n[vu(r)]=t(o),n),{})});function ju(e,t){return ee("array",n=>{let r;if(Array.isArray(n))r=n;else if(typeof n=="string")try{const o=JSON.parse(n);Array.isArray(o)&&(r=o)}catch{}return r||nt(n),r.map(e)})}let Ge=class Us extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Us.prototype)}};function Ls(e){return e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}function Du(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const Bu="ERR_INVALID_VALUE",Nu="ERR_UNEXPECTED_VALUE",Uu="ERR_UNEXPECTED_TYPE",Vs="ERR_PARSE";function Is(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new Ge(Vs,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function Ms(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new Ge(Bu,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new Ge(Nu);return t}function Z(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new Ge(Vs,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function W(e,t){return Z(t||"object",n=>{const r=Ms(n);return Is(e,o=>r[o])})}function rt(e){throw new Ge(Uu,`Unexpected value received: ${JSON.stringify(e)}`)}const wt=Z("boolean",e=>{if(typeof e=="boolean")return e;const t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;rt(e)}),B=Z("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();rt(e)}),Je=Z("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=Number(e);if(!Number.isNaN(t))return t}rt(e)}),Lu=Z("date",e=>e instanceof Date?e:new Date(Je()(e)*1e3));function qs(e,t){return Z(t||"searchParams",n=>{typeof n!="string"&&!(n instanceof URLSearchParams)&&rt(n);const r=typeof n=="string"?new URLSearchParams(n):n;return Is(e,o=>{const s=r.get(o);return s===null?void 0:s})})}function fn(e){for(const t in e)e[t]=[Ls(t),e[t]];return e}const Vu=e=>{const t=Je(),n=Je(!0),r=B(),o=B(!0),s=wt(!0),i=W(fn({addedToAttachmentMenu:s,allowsWriteToPm:s,firstName:r,id:t,isBot:s,isPremium:s,languageCode:o,lastName:o,photoUrl:o,username:o}),"User")(!0);return qs(fn({authDate:Lu(),canSendAfter:n,chat:W(fn({id:t,type:r,title:r,photoUrl:o,username:o}),"Chat")(!0),chatInstance:o,chatType:o,hash:r,queryId:o,receiver:i,startParam:o,user:i}),"initData")(e)};function Iu(e){return/^#[\da-f]{6}$/i.test(e)}function Mu(e){return/^#[\da-f]{3}$/i.test(e)}function qu(e){const t=e.replace(/\s/g,"").toLowerCase();if(Iu(t))return t;if(Mu(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const Wu=Z("rgb",e=>qu(B()(e))),Hu=Z("themeParams",e=>{const t=Wu(!0);return Object.entries(Ms(e)).reduce((n,[r,o])=>(n[Du(r)]=t(o),n),{})});function Gu(e){return JSON.stringify(Object.fromEntries(Object.entries(e).map(([t,n])=>[Ls(t),n])))}const Ju=e=>{const t=B(),n=B(!0),r=wt(!0);return qs({botInline:["tgWebAppBotInline",r],initData:["tgWebAppData",Vu(!0)],initDataRaw:["tgWebAppData",n],platform:["tgWebAppPlatform",t],showSettings:["tgWebAppShowSettings",r],startParam:["tgWebAppStartParam",n],themeParams:["tgWebAppThemeParams",Hu()],version:["tgWebAppVersion",t]},"launchParams")(e)};function Fu(e){const{initDataRaw:t,startParam:n,showSettings:r,botInline:o}=e,s=new URLSearchParams;return s.set("tgWebAppPlatform",e.platform),s.set("tgWebAppThemeParams",Gu(e.themeParams)),s.set("tgWebAppVersion",e.version),t&&s.set("tgWebAppData",t),n&&s.set("tgWebAppStartParam",n),typeof r=="boolean"&&s.set("tgWebAppShowSettings",r?"1":"0"),typeof o=="boolean"&&s.set("tgWebAppBotInline",o?"1":"0"),s.toString()}const zu=W({eventType:B(),eventData:e=>e},"miniAppsMessage"),Ws=Z("fn",e=>{if(typeof e=="function")return e;rt(e)});function Zu(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}const Ku=W({TelegramWebviewProxy:W({postEvent:Ws()})()});function Hs(e){return Ku().isValid(e)}function Yu(){try{return window.self!==window.top}catch{return!0}}var Xu=Object.defineProperty,Qu=(e,t,n)=>t in e?Xu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Gs=(e,t,n)=>Qu(e,typeof t!="symbol"?t+"":t,n);let m=class Js extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,Object.setPrototypeOf(this,Js.prototype)}};function Tn(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function be(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}const ep="ERR_ABORTED",tp="ERR_CANCELED",np="ERR_TIMED_OUT";function co(e){return new m(ep,{cause:e})}function uo(e,t){return e.reject=t.reject,e}class P extends Promise{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s,i;super((a,u)=>{o||(o={});const{abortSignal:c}=o;if(c&&c.aborted)return u(co(c.reason));const[p,h]=be(),b=l=>(...A)=>(h(),l(...A)),E=new AbortController,{signal:w}=E;i=b(l=>{E.abort(l),u(l)}),s=b(a),c&&p(Tn(c,"abort",()=>{i(co(c.reason))}));const{timeout:d}=o;if(d){const l=setTimeout(()=>{i(new m(np,`Timeout reached: ${d}ms`))},d);p(()=>{clearTimeout(l)})}r&&r(s,i,w)}),Gs(this,"reject"),this.reject=i}static withFn(t,n){return new P((r,o,s)=>{try{const i=t(s);return i instanceof Promise?i.then(r,o):r(i)}catch(i){o(i)}},n)}static resolve(t){return new P(n=>{n(t)})}static reject(t){return new P((n,r)=>{r(t)})}cancel(){this.reject(new m(tp))}catch(t){return this.then(void 0,t)}finally(t){return uo(super.finally(t),this)}then(t,n){return uo(super.then(t,n),this)}}function po(e,t){return e.resolve=t.resolve,e}class xe extends P{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s;super((i,a,u)=>{s=i,r&&r(i,a,u)},o),Gs(this,"resolve"),this.resolve=s}static withFn(t,n){return new xe((r,o,s)=>P.withFn(t,{abortSignal:s}).then(r,o),n)}static resolve(t){return new xe(n=>{n(t)})}static reject(t){return new xe((n,r)=>{r(t)})}catch(t){return this.then(void 0,t)}finally(t){return po(super.finally(t),this)}then(t,n){return po(super.then(t,n),this)}}function Fs(e){return`tapps/${e}`}function V(e,t){sessionStorage.setItem(Fs(e),JSON.stringify(t))}function I(e){const t=sessionStorage.getItem(Fs(e));try{return t?JSON.parse(t):void 0}catch{}}function hr(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function rp(e,t){t||(t={});const{textColor:n,bgColor:r,shouldLog:o=!0}=t;function s(i,...a){if(!o||typeof o=="function"&&!o())return;const u="font-weight:bold;padding:0 5px;border-radius:5px";console[i](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${u};background-color: lightblue;color:black`,"",`${u};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...a)}return[function(...i){s("log",...i)},function(...i){s("error",...i)}]}function br(e,t){document.documentElement.style.setProperty(e,t)}function gr(e){document.documentElement.style.removeProperty(e)}function op(e,t){t()}function ge(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const p=o;o=c,op(u,()=>{[...r].forEach(([h,b])=>{h(c,p),b&&a(h,!0)})})}};function i(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const a=(c,p)=>{const h=i(p),b=r.findIndex(([E,w])=>E===c&&w.once===h.once&&w.signal===h.signal);b>=0&&r.splice(b,1)},u=Object.assign(function(){return sp(u),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,p){return r.push([c,i(p)]),()=>a(c,p)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return u}const _n=[];function sp(e){_n.length&&_n[_n.length-1].add(e)}const ip=ge(!1),[zs,ap]=rp("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:ip}),cp={clipboard_text_received:W({req_id:B(),data:e=>e===null?e:B(!0)(e)},"clipboard_text_received"),custom_method_invoked:W({req_id:B(),result:e=>e,error:B(!0)},"custom_method_invoked"),popup_closed:Z("popup_closed",e=>e?W({button_id:t=>t==null?void 0:B()(t)})()(e):{}),viewport_changed:W({height:Je(),width:e=>e==null?window.innerWidth:Je()(e),is_state_stable:wt(),is_expanded:wt()},"viewport_changed")};function up(e){const t=window,[,n]=be(Tn(t,"resize",()=>{e(["viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0}])}),Tn(t,"message",r=>{if(r.source!==t.parent)return;let o;try{o=zu()(r.data)}catch{return}const{eventType:s,eventData:i}=o,a=cp[s];try{const u=a?a()(i):i;zs("Event received:",u?{eventType:s,eventData:u}:{eventType:s}),e([s,u])}catch(u){ap([`An error occurred processing the "${s}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),o,u)}}));return n}const lo=ge(),fo=ge();function pp(){return fo()||fo.set(up(lo.set)),lo}const dn=ge({});function Zs(e){let t=dn()[e];return t||(t=ge(void 0,{equals(){return!1}}),pp().sub(n=>{n&&n[0]===e&&t.set(n[1])}),dn.set({...dn(),[e]:t})),t}function j(e,t,n){return Zs(e).sub(t,n)}const lp="ERR_METHOD_UNSUPPORTED",fp="ERR_RETRIEVE_LP_FAILED",_p="ERR_METHOD_PARAMETER_UNSUPPORTED",Ks="ERR_UNKNOWN_ENV",dp="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",hp=ge("https://web.telegram.org");function mr(e,t){zs("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const n=window;if(Hs(n)){n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}const r=JSON.stringify({eventType:e,eventData:t});if(Yu())return n.parent.postMessage(r,hp());const{external:o}=n;if(W({notify:Ws()})().isValid(o)){o.notify(r);return}throw new m(Ks)}function wr(e,t,n){n||(n={});const{capture:r}=n,[o,s]=be();return new P(i=>{(Array.isArray(t)?t:[t]).forEach(a=>{o(j(a,u=>{(!r||(Array.isArray(t)?r({event:a,payload:u}):r(u)))&&i(u)}))}),(n.postEvent||mr)(e,n.params)},n).finally(s)}function Ys(e){return Ju()(e)}function Xs(e){return Ys(e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function bp(){return Xs(window.location.href)}function gp(){const e=performance.getEntriesByType("navigation")[0];if(!e)throw new Error("Unable to get first navigation entry.");return Xs(e.name)}const mp="launchParams";function wp(){return Ys(I(mp)||"")}function yp(e){V("launchParams",Fu(e))}function Qs(e){return e instanceof Error?e.message+(e.cause?`
  ${Qs(e.cause)}`:""):JSON.stringify(e)}function Vt(){const e=[];for(const t of[bp,gp,wp])try{const n=t();return yp(n),n}catch(n){e.push(n)}throw new m(fp,["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment","Collected errors:",...e.map(t=>`â€” ${Qs(t)}`)].join(`
`))}function _o(e){try{return Vt(),!0}catch{return!1}return P.withFn(async()=>{if(Hs(window))return!0;try{return await wr("web_app_request_theme","theme_changed",{timeout:100}),!0}catch{return!1}},e)}function $p(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}function vp(){[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{let t=window;e.forEach((n,r,o)=>{if(r===o.length-1){t[n]=$p;return}n in t||(t[n]={}),t=t[n]})})}function Ep(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(e=>{delete window[e]})}function me(e,t,n){Zs(e).unsub(t,n)}function Cp(e){return({req_id:t})=>t===e}function ho(e){return e.split(".").map(Number)}function Sp(e,t){const n=ho(e),r=ho(t),o=Math.max(n.length,r.length);for(let s=0;s<o;s+=1){const i=n[s]||0,a=r[s]||0;if(i!==a)return i>a?1:-1}return 0}function x(e,t){return Sp(e,t)<=0}function se(e,t,n){if(typeof n=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return x("6.4",n);if(t==="try_browser")return x("7.6",n)}if(e==="web_app_set_header_color"&&t==="color")return x("6.9",n);if(e==="web_app_close"&&t==="return_back")return x("7.6",n);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return x("7.10",n)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return x("6.1",t);case"web_app_open_popup":return x("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return x("6.4",t);case"web_app_switch_inline_query":return x("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return x("6.9",t);case"web_app_setup_settings_button":return x("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return x("7.2",t);case"web_app_setup_swipe_behavior":return x("7.7",t);case"web_app_share_to_story":return x("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return x("7.10",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Ap(e,t){t||(t="strict");const n=typeof t=="function"?t:r=>{const{method:o,version:s}=r;let i,a;if("param"in r?(i=`Parameter "${r.param}" of "${o}" method is unsupported in Mini Apps version ${s}`,a=_p):(i=`Method "${o}" is unsupported in Mini Apps version ${s}`,a=lp),t==="strict")throw new m(a,i);return console.warn(i)};return(r,o)=>se(r,e)?Zu(o)&&r==="web_app_set_header_color"&&"color"in o&&!se(r,"color",e)?n({version:e,method:r,param:"color"}):mr(r,o):n({version:e,method:r})}function Rp(e,t,n,r){return wr("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:e,params:t,req_id:n},capture:Cp(n)}).then(({result:o,error:s})=>{if(s)throw new m(dp,s);return o})}function xp(){return performance.getEntriesByType("navigation")[0]}function K(){const e=xp();return!!e&&e.type==="reload"}let ue;function kp(e,t){ue&&ue.set(e,t)||t()}function Tp(e){if(ue)return e();ue=new Map;try{e()}finally{ue.forEach(t=>t()),ue=void 0}}function _(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const p=o;o=c,kp(u,()=>{[...r].forEach(([h,b])=>{h(c,p),b&&a(h,!0)})})}};function i(c){const p=typeof c!="object"?{once:c}:c;return{once:p.once||!1,signal:p.signal||!1}}const a=(c,p)=>{const h=i(p),b=r.findIndex(([E,w])=>E===c&&w.once===h.once&&w.signal===h.signal);b>=0&&r.splice(b,1)},u=Object.assign(function(){return Pp(u),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,p){return r.push([c,i(p)]),()=>a(c,p)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return u}const ke=[];function Pp(e){ke.length&&ke[ke.length-1].add(e)}function S(e,t){let n=new Set,r;function o(){return r||(r=_(i(),t))}function s(){o().set(i())}function i(){n.forEach(c=>{c.unsub(s,{signal:!0})});const a=new Set;let u;ke.push(a);try{u=e()}finally{ke.pop()}return a.forEach(c=>{c.sub(s,{signal:!0})}),n=a,u}return Object.assign(function(){return o()()},{destroy(){o().destroy()},sub(...a){return o().sub(...a)},unsub(...a){o().unsub(...a)},unsubAll(...a){o().unsubAll(...a)}})}const Op=_((()=>{let e=0;return()=>(e+=1).toString()})()),ei=_(mr),X=_("0.0");function jp(e){e||(e={});const{postEvent:t}=e,n=e.version||Vt().version;X.set(n),ei.set(typeof t=="function"?t:Ap(n))}function Dp(){return Op()()}function It(e,t,n){return Rp(e,t,Dp(),{...n||{},postEvent:$})}const ae=(e,t,n)=>(n||(n={}),n.postEvent||(n.postEvent=$),wr(e,t,n)),$=(e,t)=>ei()(e,t);function Bp(e){return S(()=>se(e,X()))}const ve="ERR_POPUP_INVALID_PARAMS",yr="ERR_INVALID_URL",Np="ERR_INVALID_SLUG",ti="ERR_ALREADY_REQUESTING",$r="ERR_ALREADY_OPENED",Up="ERR_ALREADY_MOUNTING",Lp="ERR_VARS_ALREADY_BOUND",Vp="ERR_NOT_AVAILABLE",Ip="ERR_NOT_INITIALIZED",bo="ERR_NOT_SUPPORTED",Mp="ERR_NOT_MOUNTED";function go(){return typeof window>"u"}function ni(e,t,{isSupported:n,isMounted:r,component:o,supports:s}={}){const i=`${o?`${o}.`:""}${e}()`;n=n?Array.isArray(n)||typeof n=="object"&&"any"in n?n:[n]:void 0;function a(d){if(s){const l=s[d];return se(l[0],l[1],X())}return!0}const u=()=>{if(!n)return;const d=`it is unsupported in Mini Apps version ${X()}`;function l(v){return typeof v=="string"?se(v,X())?void 0:d:v.fn()?void 0:v.error}if(Array.isArray(n)){for(const v of n){const ye=l(v);if(ye)return ye}return}let A;for(const v of n.any)if(A=l(v),!A)return;return d},c=(...d)=>{if(s){for(const l in s)if(s[l][2](...d)&&!a(l))return`option ${l} is not supported in Mini Apps version ${X()}`}},p=S(()=>!u()),h=S(()=>X()!=="0.0"),b=S(()=>!r||r()),E=S(()=>_o("simple")&&!go()&&h()&&p()&&b());let w;if(s){w={};for(const d in s)w[d]=S(()=>a(d))}return Object.assign((...d)=>{const l=`Unable to call the ${i} ${o?"method":"function"}:`;if(go()||!_o("simple"))throw new m(Ks,`${l} it can't be called outside Mini Apps`);if(!h())throw new m(Ip,`${l} the SDK was not initialized. Use the SDK init() function`);const A=u();if(A)throw new m(bo,`${l} ${A}`);const v=c(...d);if(v)throw new m(bo,`${l} ${v}`);if(!b())throw new m(Mp,`${l} the component is not mounted. Use the ${o}.mount() method`);return t(...d)},t,{isAvailable:E,ifAvailable(...d){return E()?t(...d):void 0}},n?{isSupported:p}:{},w?{supports:w}:{})}function Mt(e,t){return t||(t={}),(n,r,o,s)=>ni(n,r,{...t,isSupported:o||t.isSupported,supports:s,component:e})}function we(e,t,n){return Mt(e,{isSupported:n,isMounted:t})}function M(e,t){return Mt(e,{isSupported:t})}const vr="web_app_setup_back_button",ri="back_button_pressed",qt="backButton",mo=_(!1),Pn=_(!1),oi=we(qt,Pn,vr),Er=M(qt,vr);oi("hide",()=>{Cr(!1)});Er("mount",()=>{Pn()||(Cr(K()&&I(qt)||!1),Pn.set(!0))});function Cr(e){e!==mo()&&($(vr,{is_visible:e}),V(qt,e),mo.set(e))}Er("onClick",e=>j(ri,e));Er("offClick",e=>{me(ri,e)});oi("show",()=>{Cr(!0)});function si(e,t,n,{isMounting:r,isMounted:o,mountError:s}){return i=>P.withFn(async a=>{if(o())return;if(r())throw new m(Up,`The ${e} component is already mounting`);r.set(!0);let u;try{u=[!0,await t({abortSignal:a})]}catch(c){u=[!1,c]}Tp(()=>{if(r.set(!1),o.set(!0),u[0])n(u[1]);else{const c=u[1];throw s.set(c),c}})},i)}const te=Mt,ii=_(),hn=_(!1),bn=_(!1),ai=_(!1),qp=_(!1),Wp=_(void 0);function Sr(e){return e.available?{available:!0,tokenSaved:e.token_saved,deviceId:e.device_id,accessRequested:e.access_requested,type:e.type,accessGranted:e.access_granted}:{available:!1}}const wo="web_app_biometry_get_info",Hp=ni("requestBiometry",e=>ae(wo,"biometry_info_received",e).then(Sr),{isSupported:wo}),Ar="web_app_biometry_request_auth",Gp="web_app_biometry_request_access",Jp="web_app_biometry_open_settings",Fp="web_app_biometry_update_token",ci="biometry_info_received",le="biometry",zp=te(le),Zp=M(le,Ar),Rr=we(le,ai,Ar);function ui(){throw new m(Vp,"Biometry is not available")}Rr("authenticate",e=>P.withFn(async t=>{if(hn())throw new m(ti,"Authentication is already in progress");const n=ii();(!n||!n.available)&&ui(),hn.set(!0);try{const r=await ae(Ar,"biometry_auth_requested",{abortSignal:t,params:{reason:((e||{}).reason||"").trim()}}),{token:o}=r;return typeof o=="string"&&Wt({...n,token:o}),r}finally{hn.set(!1)}},e));Zp("openSettings",()=>{$(Jp)});Rr("requestAccess",e=>P.withFn(async t=>{if(bn())throw new m(ti,"Access request is already in progress");bn.set(!0);try{const n=await ae(Gp,ci,{abortSignal:t,params:{reason:(e||{}).reason||""}}).then(Sr);return n.available||ui(),Wt(n),n.accessGranted}finally{bn.set(!1)}},e));zp("mount",si(le,e=>K()&&I(le)||Hp(e),e=>{j(ci,Kp),Wt(e)},{isMounted:ai,mountError:Wp,isMounting:qp}));const Kp=e=>{Wt(Sr(e))};function Wt(e){ii.set(e),V(le,e)}Rr("updateToken",e=>(e||(e={}),ae(Fp,"biometry_token_updated",{...e,params:{token:e.token||"",reason:e.reason}}).then(t=>t.status)));function Ht(e,t){return Mt(e,{isMounted:t})}const Gt="closingBehavior",yo=_(!1),On=_(!1),pi=Ht(Gt,On),Yp=te(Gt);pi("disableConfirmation",()=>{xr(!1)});pi("enableConfirmation",()=>{xr(!0)});Yp("mount",()=>{On()||(xr(K()&&I(Gt)||!1),On.set(!0))});function xr(e){e!==yo()&&($("web_app_setup_closing_behavior",{need_confirmation:e}),V(Gt,e),yo.set(e))}const Xp="web_app_invoke_custom_method",Jt=M("cloudStorage",Xp);Jt("deleteItem",(e,t)=>{const n=Array.isArray(e)?e:[e];return n.length?It("deleteStorageValues",{keys:n},t).then():P.resolve()});function Qp(e,t){const n=Array.isArray(e)?e:[e];return n.length?It("getStorageValues",{keys:n},t).then(r=>{const o=xn(Object.fromEntries(n.map(s=>[s,We()])))()(r);return Array.isArray(e)?o:o[e]}):P.resolve(typeof e=="string"?"":{})}Jt("getItem",Qp);Jt("getKeys",e=>It("getStorageKeys",{},e).then(ju(We())()));Jt("setItem",(e,t,n)=>It("saveStorageValue",{key:e,value:t},n).then());const Ft="web_app_trigger_haptic_feedback",kr=M("hapticFeedback",Ft);kr("impactOccurred",e=>{$(Ft,{type:"impact",impact_style:e})});kr("notificationOccurred",e=>{$(Ft,{type:"notification",notification_type:e})});kr("selectionChanged",()=>{$(Ft,{type:"selection_change"})});function lf(e){return ku()(e)}const li="web_app_open_invoice",el=M("invoice",li),gn=_(!1);async function tl(e,t,n){if(gn())throw new m($r,"An invoice is already opened");let r;if(t==="url"){const{hostname:o,pathname:s}=new URL(e,window.location.href);if(o!=="t.me")throw new m(yr,`Link has unexpected hostname: ${o}`);const i=s.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!i)throw new m(Np,'Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,r]=i}else r=e,n=t;return gn.set(!0),ae(li,"invoice_closed",{...n,params:{slug:r},capture:o=>r===o.slug}).then(o=>o.status).finally(()=>{gn.set(!1)})}el("open",tl);function fi(e){const t=Ns(e);return Math.sqrt([.299,.587,.114].reduce((n,r,o)=>{const s=parseInt(t.slice(1+o*2,1+(o+1)*2),16);return n+s*s*r},0))<120}const Fe=_(!1),lt=_(!1),re=_({});function T(e){return S(()=>re()[e])}const nl=T("accentTextColor"),Tr=T("bgColor"),Pr=T("buttonColor"),_i=T("buttonTextColor"),di=T("bottomBarBgColor"),rl=T("destructiveTextColor"),ol=T("headerBgColor"),sl=T("hintColor"),il=S(()=>{const{bgColor:e}=re();return!e||fi(e)}),al=T("linkColor"),yt=T("secondaryBgColor"),cl=T("sectionBgColor"),ul=T("sectionHeaderTextColor"),pl=T("sectionSeparatorColor"),ll=T("subtitleTextColor"),fl=T("textColor"),Te=_({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),_l=S(()=>{const e=Te();return{...e,backgroundColor:e.backgroundColor||Pr()||"#2481cc",textColor:e.textColor||_i()||"#ffffff"}}),jn=_(!1),dl="web_app_setup_main_button",hi="main_button_pressed",zt="mainButton",Or=te(zt),hl=Ht(zt,jn);Or("mount",()=>{if(!jn()){const e=K()&&I(zt);e&&Te.set(e),jn.set(!0)}});Or("onClick",e=>j(hi,e));Or("offClick",e=>{me(hi,e)});hl("setParams",e=>{Te.set({...Te(),...Object.fromEntries(Object.entries(e).filter(([,n])=>n!==void 0))}),V(zt,Te());const t=_l();t.text&&$(dl,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,text:t.text,text_color:t.textColor})});function jr(){throw new m(Lp,"CSS variables are already bound")}function bl(e){return Ou()(e)}const Zt="themeParams",bi="theme_changed",gl=te(Zt),ml=Ht(Zt,Fe),wl=ml("bindCssVars",e=>{lt()&&jr(),e||(e=r=>`--tg-theme-${hr(r)}`);function t(r){Object.entries(re()).forEach(([o,s])=>{s&&r(o,s)})}function n(){t((r,o)=>{br(e(r),o)})}return n(),re.sub(n),lt.set(!0),()=>{t(gr),re.unsub(n),lt.set(!1)}}),gi=gl("mount",()=>{Fe()||(j(bi,mi),re.set(K()&&I(Zt)||Vt().themeParams),Fe.set(!0))}),mi=e=>{const t=bl(e.theme_params);re.set(t),V(Zt,t)};function yl(){me(bi,mi),Fe.set(!1)}function wi(e){return S(()=>{const t=e();return He(t)?t:t==="bg_color"?Tr():yt()})}const ze=_("bg_color"),Dr=wi(ze),Ze=_("bottom_bar_bg_color"),Br=S(()=>{const e=Ze();return He(e)?e:e==="bottom_bar_bg_color"?di()||yt():e==="secondary_bg_color"?yt():Tr()}),Ke=_("bg_color"),yi=wi(Ke),Ye=_(!1),ft=_(!1),$l=S(()=>{const e=Dr();return e?fi(e):!1}),$i=S(()=>({backgroundColor:ze(),bottomBarColor:Ze(),headerColor:Ke()})),Dn="web_app_set_background_color",Bn="web_app_set_bottom_bar_color",_t="web_app_set_header_color",ot="miniApp",Nr={any:[Dn,Bn,_t]},vl=S(()=>Nr.any.some(e=>se(e,X()))),vi=te(ot),El=M(ot,Nr),Kt=we(ot,Ye,Nr),Cl=Kt("bindCssVars",e=>{ft()&&jr();const[t,n]=be();function r(o,s){function i(){br(o,s()||null)}i(),t(s.sub(i),gr.bind(null,o))}return e||(e=o=>`--tg-${hr(o)}`),r(e("bgColor"),Dr),r(e("bottomBarColor"),Br),r(e("headerColor"),yi),t(()=>{ft.set(!1)}),ft.set(!0),n}),Sl=vi("close",e=>{$("web_app_close",{return_back:e})}),Al=El("mount",()=>{if(!Ye()){const e=K()&&I(ot);gi(),Ei.ifAvailable(e?e.backgroundColor:"bg_color"),Ci.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),Si.ifAvailable(e?e.headerColor:"bg_color"),Ye.set(!0)}}),Rl=vi("ready",()=>{$("web_app_ready")});function Ur(){V(ot,$i())}const Ei=Kt("setBackgroundColor",e=>{e!==ze()&&($(Dn,{color:e}),ze.set(e),Ur())},Dn),Ci=Kt("setBottomBarColor",e=>{e!==Ze()&&($(Bn,{color:e}),Ze.set(e),Ur())},Bn),Si=Kt("setHeaderColor",e=>{e!==Ke()&&($(_t,He(e)?{color:e}:{color_key:e}),Ke.set(e),Ur())},_t,{rgb:[_t,"color",He]});function xl(){Ye.set(!1)}const ff=Object.freeze(Object.defineProperty({__proto__:null,backgroundColor:ze,backgroundColorRGB:Dr,bindCssVars:Cl,bottomBarColor:Ze,bottomBarColorRGB:Br,close:Sl,headerColor:Ke,headerColorRGB:yi,isCssVarsBound:ft,isDark:$l,isMounted:Ye,isSupported:vl,mount:Al,ready:Rl,setBackgroundColor:Ei,setBottomBarColor:Ci,setHeaderColor:Si,state:$i,unmount:xl},Symbol.toStringTag,{value:"Module"}));function kl(e){const t=e.message.trim(),n=(e.title||"").trim(),r=e.buttons||[];if(n.length>64)throw new m(ve,`Invalid title: ${n}`);if(!t||t.length>256)throw new m(ve,`Invalid message: ${t}`);if(r.length>3)throw new m(ve,`Invalid buttons count: ${r.length}`);return{title:n,message:t,buttons:r.length?r.map((o,s)=>{const i=o.id||"";if(i.length>64)throw new m(ve,`Button with index ${s} has invalid id: ${i}`);if(!o.type||o.type==="default"||o.type==="destructive"){const a=o.text.trim();if(!a||a.length>64)throw new m(ve,`Button with index ${s} has invalid text: ${a}`);return{type:o.type,text:a,id:i}}return{type:o.type,id:i}}):[{type:"close",id:""}]}}const Lr="web_app_open_popup",Tl=M("popup",Lr),dt=_(!1),Pl=Bp(Lr),Ol=Tl("open",async e=>{if(dt())throw new m($r,"A popup is already opened");dt.set(!0);try{const{button_id:t=null}=await ae(Lr,"popup_closed",{...e,params:kl(e)});return t}finally{dt.set(!1)}}),_f=Object.freeze(Object.defineProperty({__proto__:null,isOpened:dt,isSupported:Pl,open:Ol},Symbol.toStringTag,{value:"Module"})),jl="web_app_close_scan_qr_popup",Ai="web_app_open_scan_qr_popup",Dl="scan_qr_popup_closed",Bl="qr_text_received",Ri=M("qrScanner",Ai),$o=Ri("close",()=>{Ce.set(!1),$(jl)}),Ce=_(!1);function Nl(e){return P.withFn(t=>{if(Ce())throw new m($r,"The QR Scanner is already opened");Ce.set(!0),e||(e={});const{onCaptured:n,text:r,capture:o}=e,[,s]=be(Ce.sub(()=>{i.resolve()}),j(Dl,()=>{Ce.set(!1)}),j(Bl,a=>{n?n(a.data):(!o||o(a.data))&&(i.resolve(a.data),$o())})),i=new xe({abortSignal:t}).catch($o).finally(s);return(e.postEvent||$)(Ai,{text:r}),i},e)}Ri("open",Nl);const Pe=_({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),Ul=S(()=>{const e=Pe();return{...e,backgroundColor:e.backgroundColor||Br()||"#000000",textColor:e.textColor||Pr()||"#2481cc"}}),Nn=_(!1),Vr="web_app_setup_secondary_button",xi="secondary_button_pressed",Yt="secondaryButton",Ir=M(Yt,Vr),Ll=we(Yt,Nn,Vr);Ir("mount",()=>{if(!Nn()){const e=K()&&I(Yt);e&&Pe.set(e),Nn.set(!0)}});Ir("onClick",e=>j(xi,e));Ir("offClick",e=>{me(xi,e)});Ll("setParams",e=>{Pe.set({...Pe(),...Object.fromEntries(Object.entries(e).filter(([,n])=>n!==void 0))}),V(Yt,Pe());const t=Ul();t.text&&$(Vr,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,position:t.position,text:t.text,text_color:t.textColor})});const Mr="web_app_setup_settings_button",ki="settings_button_pressed",Xt="settingsButton",vo=_(!1),Un=_(!1),qr=M(Xt,Mr),Ti=we(Xt,Un,Mr);Ti("hide",()=>{Wr(!1)});qr("mount",()=>{Un()||(Wr(K()&&I(Xt)||!1),Un.set(!0))});function Wr(e){e!==vo()&&($(Mr,{is_visible:e}),V(Xt,e),vo.set(e))}qr("onClick",e=>j(ki,e));qr("offClick",e=>{me(ki,e)});Ti("show",()=>{Wr(!0)});const Hr="web_app_setup_swipe_behavior",Qt="swipeBehavior",Ln=_(!1),Eo=_(!0),Vl=M(Qt,Hr),Pi=we(Qt,Ln,Hr);Pi("disableVertical",()=>{Gr(!1)});Pi("enableVertical",()=>{Gr(!0)});Vl("mount",()=>{Ln()||(Gr(K()&&I(Qt)||!1,!0),Ln.set(!0))});function Gr(e,t){(e!==Eo()||t)&&($(Hr,{allow_vertical_swipe:e}),V(Qt,e),Eo.set(e))}const df=Object.freeze(Object.defineProperty({__proto__:null,accentTextColor:nl,backgroundColor:Tr,bindCssVars:wl,bottomBarBgColor:di,buttonColor:Pr,buttonTextColor:_i,destructiveTextColor:rl,headerBackgroundColor:ol,hintColor:sl,isCssVarsBound:lt,isDark:il,isMounted:Fe,linkColor:al,mount:gi,secondaryBackgroundColor:yt,sectionBackgroundColor:cl,sectionHeaderTextColor:ul,sectionSeparatorColor:pl,state:re,subtitleTextColor:ll,textColor:fl,unmount:yl},Symbol.toStringTag,{value:"Module"})),G=_({height:0,width:0,isExpanded:!1,stableHeight:0}),en=_(!1),ht=_(!1),Oi=_(!1),ji=_(void 0);function tn(e){return S(()=>G()[e])}const Il=tn("height"),Ml=tn("isExpanded"),ql=S(()=>{const e=G();return e.height===e.stableHeight}),Wl=tn("stableHeight"),Hl=tn("width");function Gl(e){return ae("web_app_request_viewport","viewport_changed",e).then(t=>({height:t.height,width:t.width,isExpanded:t.is_expanded,isStable:t.is_state_stable}))}const $t="viewport",Di=te($t),Jl=Ht($t,en),Fl=Jl("bindCssVars",e=>{ht()&&jr(),e||(e=r=>`--tg-viewport-${hr(r)}`);const t=["height","width","stableHeight"];function n(){t.forEach(r=>{br(e(r),`${G()[r]}px`)})}return n(),G.sub(n),ht.set(!0),()=>{t.forEach(gr),G.unsub(n),ht.set(!1)}}),zl=Di("expand",()=>{$("web_app_expand")}),Zl=Di("mount",si($t,e=>{const t=K()&&I($t);if(t)return t;if(["macos","tdesktop","unigram","webk","weba","web"].includes(Vt().platform)){const n=window;return{isExpanded:!0,height:n.innerHeight,width:n.innerWidth,stableHeight:n.innerHeight}}return e.timeout||(e.timeout=1e3),Gl(e).then(n=>({height:n.height,isExpanded:n.isExpanded,stableHeight:n.isStable?n.height:G().stableHeight,width:n.width}))},e=>{j("viewport_changed",Bi),Ni(e)},{isMounted:en,isMounting:Oi,mountError:ji})),Bi=e=>{Ni({height:e.height,isExpanded:e.is_expanded,stableHeight:e.is_state_stable?e.height:G().stableHeight,width:e.width})};function Ni(e){G.set({isExpanded:e.isExpanded,height:mn(e.height),width:mn(e.width),stableHeight:mn(e.stableHeight)}),V("viewport",G())}function mn(e){return Math.max(e,0)}function Kl(){me("viewport_changed",Bi),en.set(!1)}const hf=Object.freeze(Object.defineProperty({__proto__:null,bindCssVars:Fl,expand:zl,height:Il,isCssVarsBound:ht,isExpanded:Ml,isMounted:en,isMounting:Oi,isStable:ql,mount:Zl,mountError:ji,stableHeight:Wl,state:G,unmount:Kl,width:Hl},Symbol.toStringTag,{value:"Module"})),Yl=te();Yl("openLink",(e,t)=>{if(typeof e=="string")try{e=new URL(e)}catch(n){throw new m(yr,`"${e.toString()}" is invalid URL`,n)}t||(t={}),$("web_app_open_link",{url:e.toString(),try_browser:t.tryBrowser,try_instant_view:t.tryInstantView})});const Co="web_app_open_tg_link",Xl=te(),Ql=Xl("openTelegramLink",e=>{const t=e.toString();if(!t.match(/^https:\/\/t.me\/.+/))throw new m(yr,`"${t}" is invalid URL`);if(!se(Co,X())){window.location.href=t;return}e=new URL(e),$(Co,{path_full:e.pathname+e.search})}),ef=te(),bf=ef("shareURL",(e,t)=>{Ql("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))});function gf(e){jp(e),vp();const[t,n]=be(j("reload_iframe",()=>{$("iframe_will_reload"),window.location.reload()}),Ep),{acceptCustomStyles:r=!0}={};if(r){const o=document.createElement("style");o.id="telegram-custom-styles",document.head.appendChild(o),t(j("set_custom_style",s=>{o.innerHTML=s}),()=>{document.head.removeChild(o)})}return $("iframe_ready",{reload_supported:!0}),n}export{lf as J,ff as K,_f as Z,je as a,of as b,af as c,bf as d,Jr as f,cf as g,sf as i,gf as m,df as o,hf as s,rf as t,uf as w,pf as y,nf as z};
